<!DOCTYPE html>
<html>
<head>
	<title>PushPop</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="style/basic.css" />
	<link rel="stylesheet" type="text/css" href="style/jquery-mobile-1.1.0.css" />
	<link rel="stylesheet" type="text/css" href="style/jqmobiledialogfix.css" />
	<script src="script/jquery-1.7.1.js"></script>
	<script src="script/jquery-mobile-1.1.0.js"></script>
	<script src="script/jquery.jrumble.1.3.js"></script>
	<script src="script/jqm.page.params.js"></script>

	<script src="script/pushpop-ui.js"></script>
	<script src="script/timer.js"></script>
	<script src="script/pushpop.js"></script>
	
	<script src="../src-platform/cordova-1.7.0.js"></script>
	<script src="../src-platform/adPlugin.js"></script>
	<script src="../src-platform/setup.js"></script>

</head>
<body id="pushpop">
	<div id="puzzle" data-role="page" data-title="PushPop"  data-dom-cache="true" data-theme="a">
		<div id="toolbar" data-role="header">
<!--
-->
			<a id="menuBtn" data-inline="true" data-mini="true" data-icon="grid" data-role="button">Menu</a>
			<h1>PushPop</h1>
			<a href="#pause" data-inline="true" data-mini="true" data-transition="flip" data-icon="pause" data-role="button"><div id="timer">00:00</div></a>
		</div>
		<div id="workarea" class="workarea" data-role="content">
			<div id="gameMenu" class="ui-body ui-body-a">
				<a data-role="button" data-theme="b" id="newBtn" data-mini="true" data-icon="star">New Puzzle</a>
				<a data-role="button" data-theme="b" id="startOverBtn" data-mini="true" data-icon="refresh">Start Over</a>
				<a data-role="button" data-theme="b" href="help.html" data-mini="true" data-icon="info" data-transition="slide">Help</a>
			</div>
			<div id="game" class="game">
				<div id="game-stack" class="stack"></div>
				<div id="game-board" class="game_board"></div>
			</div>
		</div>
	</div>
	
	<div id="pause" data-role="page" data-theme="a" data-title="PushPop - Paused">
		<div class="pauseContent">
			<span>PushPop Paused</span>
			<a href="#puzzle" data-role="button" data-rel="back" id="resumeBtn">Resume</a>
		</div>
	</div>

	<div id="newGameConfirm" data-role="dialog" data-title="PushPop - New Game" data-theme="c">
		<span>You haven't quite finished with the current puzzle.  Do you want to try a new one or keep working on this one?</span>
		<div class="buttons">
			<a href="#puzzle" data-role="button" data-inline="true" data-icon="star">New Puzzle</a>
			<a href="#puzzle" data-role="button" data-inline="true" data-icon="back" data-rel="back" data-theme="b">Keep working</a>
		</div>
	</div>

	<div id="gameOver" data-role="dialog" data-title="PushPop - Solved!">
		<h1>Congratulations!</h1>
		<div id="stats"></div>
		<div id="quip"></div>
		<div class="buttons">
			<a href="#puzzle" data-role="button" data-theme="b" data-icon="star">I'm ready for a new puzzle</a>
		</div>
	</div>
	
	<script>
	
function setSize() {
	var sWidth = window.innerWidth;
	var sHeight = window.innerHeight;
	if ((sWidth > 900 && sHeight >= 600) 
		|| (sWidth > 600 && sHeight > 900)) {
		$("body").addClass("large").removeClass("medium").removeClass("small");
	} else if ((sWidth >= 640 && sHeight >= 480) 
		|| (sWidth >= 480 && sHeight >= 640)) {
		$("body").removeClass("large").addClass("medium").removeClass("small");
	} else {
		$("body").removeClass("large").removeClass("medium").addClass("small");
	}	
}

$("#puzzle").bind('pageinit', function() {
  	// not using vclick or tap because of note on http://jquerymobile.com/test/docs/api/events.html
  	// need to revisit if the click responsiveness is too slow
  	$("#menuBtn").bind("click", function() { $("#gameMenu").toggle(100); });
  	$("#newBtn").bind("click", $.proxy(PushPopUI.newPuzzle, PushPopUI));
  	$("#startOverBtn").bind("click", $.proxy(PushPopUI.startOver, PushPopUI));
	$("#game").bind("click", function() { $("#gameMenu").hide(100); } );
	setSize();
	window.addEventListener("resize", setSize);
});

$(document).bind('pagechange', function(e, data) {
	if (data.toPage[0].id == "puzzle") {
		var id = data.options.pageData ? data.options.pageData.game : null;
		if (!PushPopUI.game || id != PushPopUI.game.id) {
			PushPopUI.resetPuzzle(id);
		}
	}
});

$("#puzzle").bind('pagebeforehide', function() {
	PushPopUI.pauseTimer();
});
$("#puzzle").bind('pageshow', function() {
	PushPopUI.resumeTimer();
});
$("#gameOver").bind('pagehide', function() {
	PushPopUI.resetPuzzle();
});
	</script>
	<script src="script/jqmobiledialogfix.js"></script>
</body>
</html>
